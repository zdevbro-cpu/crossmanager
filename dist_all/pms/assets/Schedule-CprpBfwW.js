import{a as ne,u as Se,e as De,f as Y,b as ke,r as h,j as t,R as Ne}from"./index-Bk_PkX1w.js";import{u as se}from"./useMutation-qVMx8BuS.js";import{c as O}from"./createLucideIcon-CQVuD4m9.js";import{P as Ie,T as Me}from"./trash-2-1f4s6_-J.js";import{P as Te,S as Ce}from"./save-DAxO90IJ.js";const Ee=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],$e=O("chevron-down",Ee);const Re=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ze=O("chevron-right",Re);const Le=[["path",{d:"m15 10 5 5-5 5",key:"qqa56n"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]],We=O("corner-down-right",Le);const Oe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Pe=O("zoom-in",Oe);const Xe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Be=O("zoom-out",Xe),_e=()=>{const{selectedId:d}=ne();return Se({queryKey:["tasks",d],queryFn:async()=>{const b=d?{projectId:d}:{},{data:N}=await Y.get("/tasks",{params:b});return N},enabled:!0})},Ye=()=>{const d=De(),{selectedId:b}=ne(),N=se({mutationFn:async w=>{const{data:k}=await Y.post("/tasks",w);return k},onSuccess:()=>{d.invalidateQueries({queryKey:["tasks",b]})}}),q=se({mutationFn:async w=>{const{data:k}=await Y.put(`/tasks/${w.id}`,w);return k},onSuccess:()=>{d.invalidateQueries({queryKey:["tasks",b]})}}),j=se({mutationFn:async w=>(await Y.delete(`/tasks/${w}`),w),onSuccess:()=>{d.invalidateQueries({queryKey:["tasks",b]})}});return{createMutation:N,updateMutation:q,deleteMutation:j}},qe=40,M=40;function g(d){const b=new Date(d).getTime();return Number.isFinite(b)?b:null}function Ge(){const{data:d=[]}=_e(),{createMutation:b,updateMutation:N,deleteMutation:q}=Ye(),{show:j}=ke(),{selectedId:w}=ne(),[k,A]=h.useState(new Set),[T,ce]=h.useState(new Set),[v,re]=h.useState(qe),[C,ae]=h.useState({}),[E,F]=h.useState(null),[ue,z]=h.useState(!1),[$,H]=h.useState("create-root"),[P,K]=h.useState(null),[a,S]=h.useState({name:"",start:"",end:"",progress:0,predecessorsWbs:"",parentId:""}),he=h.useRef(null),L=h.useRef(null),D=h.useRef(null),X=h.useRef(null),Q=h.useRef(!1),[x,G]=h.useState(null),W=h.useRef(x);h.useEffect(()=>{W.current=x},[x]);const ie=e=>{if(!D.current)return;const s=Math.max(0,Math.min(D.current.scrollTop+e.deltaY,D.current.scrollHeight-D.current.clientHeight));D.current.scrollTop=s,L.current&&(L.current.style.transform=`translateY(-${s}px)`),e.preventDefault()},R=h.useMemo(()=>{let e;d.length===0?e=new Date().setHours(0,0,0,0):e=Math.min(...d.map(o=>g(o.start)||Date.now()));const s=new Date(e),n=s.getDay(),i=s.getDate()-n+(n===0?-6:1);return s.setDate(i),s.setHours(0,0,0,0),s.getTime()},[d]),B=h.useMemo(()=>{if(d.length===0)return 30;const e=Math.max(...d.map(s=>g(s.end)||Date.now()));return Math.ceil((e-R)/(1e3*60*60*24))+30},[d,R]),oe=(Date.now()-R)/(1e3*60*60*24)*v;h.useEffect(()=>{if(d.length>0&&k.size===0){const e=new Set(d.map(s=>s.id));A(e)}},[d,k]);const pe=(e,s,n)=>{D.current&&(Q.current||(Q.current=!0,L.current&&(L.current.style.transform=`translateY(-${s}px)`),X.current&&n!==void 0&&Math.abs(X.current.scrollLeft-n)>1&&(X.current.scrollLeft=n),requestAnimationFrame(()=>{Q.current=!1})))},me=e=>{pe("gantt",e.currentTarget.scrollTop,e.currentTarget.scrollLeft)},ge=e=>{if(!D.current)return;const s=e.currentTarget.scrollLeft;Math.abs(D.current.scrollLeft-s)>1&&(D.current.scrollLeft=s)};h.useEffect(()=>{const e=()=>F(null);return window.addEventListener("click",e),()=>window.removeEventListener("click",e)},[]);const f=h.useMemo(()=>{const e=d.filter(o=>!w||!o.projectId||o.projectId===w),s=new Map;e.forEach(o=>{const l=o.parentId||void 0;s.has(l)||s.set(l,[]),s.get(l).push(o)}),s.forEach(o=>o.sort((l,r)=>(l.order||0)-(r.order||0)));const n=[],i=(o,l,r)=>{(s.get(o)||[]).forEach((u,p)=>{const y=r?`${r}.${p+1}`:`${p+1}`,m=k.has(u.id);n.push({...u,depth:l,isExpanded:m,hasChildren:s.has(u.id),wbsNumber:y,index:n.length,isVisible:!0}),m&&s.has(u.id)&&i(u.id,l+1,y)})};return i(void 0,0,""),n},[d,k,w]),U=e=>e?e.map(s=>{const n=f.find(i=>i.id===s);return n?n.wbsNumber:""}).filter(Boolean).join(", "):"",Z=e=>e?e.split(",").map(n=>n.trim()).map(n=>{const i=f.find(o=>o.wbsNumber===n);return i?i.id:void 0}).filter(n=>!!n):[],xe=e=>{const s=new Set(k);s.has(e)?s.delete(e):s.add(e),A(s)},V=e=>{const s=new Set;s.add(e),ce(s)},le=(e,s)=>{e.preventDefault(),e.stopPropagation(),V(s),F({x:e.clientX,y:e.clientY,taskId:s})};h.useEffect(()=>{const e=n=>{if(!W.current)return;n.preventDefault();const{id:i,mode:o,startX:l,originalStart:r,originalEnd:c}=W.current,u=n.clientX-l,p=Math.round(u/v);G(_=>_?{..._,currentX:n.clientX,currentY:n.clientY}:null);let y=r,m=c;o==="move"?(y=r+p*24*60*60*1e3,m=c+p*24*60*60*1e3):o==="resize"&&(m=c+p*24*60*60*1e3,m<y&&(m=y));const I=new Date(y).toISOString().slice(0,10),te=new Date(m).toISOString().slice(0,10);ae(_=>({..._,[i]:{start:I,end:te}}))},s=async n=>{if(!W.current)return;const{id:i,mode:o,startX:l}=W.current,r=n.clientX-l,c=Math.round(r/v);if(ae(u=>{const p={...u};return delete p[i],p}),G(null),c!==0){const u=d.find(p=>p.id===i);if(u)try{const p=g(u.start)||Date.now(),y=g(u.end)||Date.now();let m=p,I=y;o==="move"?(m=p+c*24*60*60*1e3,I=y+c*24*60*60*1e3):o==="resize"&&(I=y+c*24*60*60*1e3,I<m&&(I=m));const te={...u,start:new Date(m).toISOString().slice(0,10),end:new Date(I).toISOString().slice(0,10)};await N.mutateAsync(te),j("일정이 변경되었습니다.","success")}catch{j("일정 변경 실패","error")}}};return x&&(window.addEventListener("mousemove",e),window.addEventListener("mouseup",s)),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",s)}},[x,v,d,N,j]);const fe=(e,s,n)=>{e.stopPropagation();const i=g(s.start),o=g(s.end);if(!i||!o)return;const l=e.currentTarget.getBoundingClientRect(),r=e.clientX-l.left,c=n-r<15;G({id:s.id,mode:c?"resize":"move",startX:e.clientX,currentX:e.clientX,currentY:e.clientY,originalStart:i,originalEnd:o})},J=e=>{H("edit"),K(e),S({name:e.name,start:String(e.start).split("T")[0],end:String(e.end).split("T")[0],progress:e.progress,predecessorsWbs:U(e.predecessors),parentId:e.parentId||""}),z(!0)},ye=()=>{H("create-root"),K(null),S({name:"",start:new Date().toISOString().slice(0,10),end:new Date(Date.now()+864e5).toISOString().slice(0,10),progress:0,predecessorsWbs:"",parentId:""}),z(!0)},je=e=>{const s=e||Array.from(T)[0];if(!s){j("상위 타스크를 먼저 선택해주세요.","warning");return}const n=d.find(i=>i.id===s);H("create-sub"),K(null),S({name:"",start:n?String(n.start).split("T")[0]:new Date().toISOString().slice(0,10),end:n?String(n.end).split("T")[0]:new Date(Date.now()+864e5).toISOString().slice(0,10),progress:0,predecessorsWbs:"",parentId:s}),z(!0)},we=async e=>{if(e.preventDefault(),!a.name||!a.start||!a.end){j("필수 항목을 입력하세요.","warning");return}const s=Z(a.predecessorsWbs),n={projectId:w||void 0,name:a.name,start:a.start,end:a.end,progress:Number(a.progress),predecessors:s,parentId:a.parentId||void 0,order:P?P.order:(d.length+1)*10};try{if($==="edit"&&P)await N.mutateAsync({...P,...n}),j("타스크가 수정되었습니다.","success");else{const i=await b.mutateAsync(n);i.parentId&&A(o=>new Set(o).add(i.parentId)),j("타스크가 추가되었습니다.","success")}z(!1)}catch(i){console.error(i),j("작업 저장 실패","error")}},ve=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{await q.mutateAsync(e),j("삭제되었습니다.","success"),F(null)}catch{j("삭제 실패","error")}};h.useEffect(()=>{if(a.predecessorsWbs&&a.name){const e=Z(a.predecessorsWbs);if(e.length>0){const s=f.find(n=>n.id===e[e.length-1]);if(s&&s.end){const n=new Date(s.end),i=new Date(n.setDate(n.getDate()+1)),o=new Date(a.start),r=new Date(a.end).getTime()-o.getTime(),c=new Date(i.getTime()+(r>0?r:864e5));S(u=>({...u,start:i.toISOString().slice(0,10),end:c.toISOString().slice(0,10)}))}}}},[a.predecessorsWbs]);const ee=e=>{const s=g(e.start),n=g(e.end);if(!s||!n)return null;const i=(s-R)/(1e3*60*60*24)*v,l=(Math.ceil((n-s)/(1e3*60*60*24))+1)*v;return{left:i,width:l}},be=()=>f.map(e=>{if(!e.predecessors||e.predecessors.length===0)return null;const s=f.find(l=>l.id===e.id);if(!s)return null;const n=ee(s);if(!n)return null;const i=s.index*M+M/2,o=n.left;return e.predecessors.map(l=>{const r=f.find(m=>m.id===l);if(!r)return null;const c=ee(r);if(!c)return null;const u=r.index*M+M/2,p=c.left+c.width,y=`M ${p} ${u} L ${p+10} ${u} L ${p+10} ${i} L ${o} ${i}`;return t.jsx("path",{d:y,stroke:"#64748b",strokeWidth:"1.5",fill:"none",markerEnd:"url(#arrowhead)"},`${e.id}-${l}`)})}),de=[];for(let e=0;e<B;e++){const s=e%7===0;de.push(t.jsx("div",{style:{position:"absolute",left:e*v,top:0,bottom:0,borderRight:"1px dashed #334155",background:s?"rgba(255,255,255,0.02)":"transparent",width:v,pointerEvents:"none"}},e))}return t.jsxs("div",{className:"page",style:{position:"relative"},children:[t.jsxs("header",{className:"section-header",style:{alignItems:"flex-end"},children:[t.jsxs("div",{children:[t.jsx("p",{className:"eyebrow",children:"공정(WBS)·일정"}),t.jsx("h2",{children:"WBS & Gantt Chart"}),t.jsx("p",{className:"muted",children:"좌측 트리와 우측 차트가 연동되는 커스텀 간트 차트입니다."})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",paddingBottom:"0.2rem"},children:[t.jsxs("div",{style:{display:"flex",gap:"0.25rem",background:"rgba(255, 255, 255, 0.05)",padding:"4px",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[t.jsx("button",{className:"icon-btn",title:"축소",onClick:()=>re(e=>Math.max(10,e-5)),children:t.jsx(Be,{size:16})}),t.jsx("button",{className:"icon-btn",title:"확대",onClick:()=>re(e=>Math.min(100,e+5)),children:t.jsx(Pe,{size:16})})]}),t.jsxs("button",{className:"pill pill-outline",onClick:ye,children:[t.jsx(Ie,{size:14,style:{marginRight:4}})," 새 작업 추가"]})]})]}),t.jsxs("div",{className:"gantt-container",children:[t.jsxs("div",{className:"gantt-wbs-pane",children:[t.jsxs("div",{className:"wbs-header",children:[t.jsx("div",{style:{width:80},children:"NO"}),t.jsx("div",{children:"WBS Name"})]}),t.jsx("div",{className:"wbs-content",ref:he,onWheelCapture:ie,style:{overflow:"hidden"},children:t.jsxs("div",{ref:L,children:[f.map(e=>{const s=T.has(e.id);return t.jsxs("div",{className:`wbs-row ${s?"row-active":""}`,onClick:()=>V(e.id),onDoubleClick:()=>J(e),onContextMenu:n=>le(n,e.id),style:{cursor:"pointer",background:s?"rgba(139, 211, 255, 0.1)":void 0},children:[t.jsx("div",{className:"wbs-cell-id",style:{width:80,paddingLeft:10,textAlign:"left",color:"#8bd3ff",fontSize:"0.85rem"},children:e.wbsNumber}),t.jsxs("div",{className:"wbs-cell-name",style:{paddingLeft:e.depth*15},children:[e.hasChildren?t.jsx("button",{className:"icon-btn",onClick:n=>{n.stopPropagation(),xe(e.id)},children:e.isExpanded?t.jsx($e,{size:14}):t.jsx(ze,{size:14})}):t.jsx("span",{style:{width:14,display:"inline-block"}}),e.name]})]},e.id)}),t.jsx("div",{style:{height:f.length===0?200:0}})]})})]}),t.jsxs("div",{className:"gantt-chart-pane",children:[t.jsx("div",{className:"timeline-header",ref:X,onScroll:ge,children:t.jsx("div",{style:{position:"relative",height:"100%",width:B*v},children:Array.from({length:Math.ceil(B/7)}).map((e,s)=>t.jsxs("div",{className:"timeline-scale-cell",style:{left:s*7*v,width:7*v},children:[new Date(R+s*7*1e3*60*60*24).getMonth()+1,"/",new Date(R+s*7*1e3*60*60*24).getDate()," (W",s+1,")"]},s))})}),t.jsx("div",{className:"gantt-body",ref:D,onScroll:me,onWheelCapture:ie,children:t.jsxs("div",{style:{position:"relative",height:f.length*M,width:B*v},children:[de,oe>=0&&t.jsx("div",{className:"today-line",style:{left:oe}}),t.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:1},children:[t.jsx("defs",{children:t.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#64748b"})})}),be()]}),f.map((e,s)=>t.jsx("div",{className:`gantt-row-bg ${T.has(e.id)?"row-active":""}`,style:{top:s*M,width:"100%",background:T.has(e.id)?"rgba(139, 211, 255, 0.05)":void 0}},e.id)),f.map((e,s)=>{const i=C[e.id]?{...e,...C[e.id]}:e,o=ee(i);if(!o)return null;const l=g(i.start),r=g(i.end),c=l&&r?Math.ceil((r-l)/(1e3*60*60*24))+1:0;return t.jsxs("div",{className:"gantt-bar-item",onDoubleClick:()=>J(e),onClick:()=>V(e.id),onContextMenu:u=>le(u,e.id),onMouseDown:u=>fe(u,e,o.width),style:{top:s*M+8,left:o.left,width:o.width,background:e.hasChildren?"#334155":void 0,border:e.hasChildren?"1px solid #475569":void 0,cursor:e.hasChildren?"default":"ew-resize",paddingRight:10},children:[t.jsxs("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",pointerEvents:"none",display:"block",width:"100%"},children:[e.name," (",c,"일)"]}),!e.hasChildren&&t.jsx("div",{className:"gantt-resize-handle",style:{position:"absolute",right:0,top:0,bottom:0,width:10,cursor:"col-resize",zIndex:2}})]},e.id)})]})})]})]}),x&&t.jsx("div",{style:{position:"fixed",top:x.currentY-40,left:x.currentX+10,background:"rgba(0,0,0,0.85)",color:"#fff",padding:"6px 10px",borderRadius:6,fontSize:"0.8rem",zIndex:1e4,pointerEvents:"none",boxShadow:"0 4px 6px rgba(0,0,0,0.3)",whiteSpace:"nowrap"},children:t.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[t.jsx("span",{style:{fontWeight:600,color:"#8bd3ff"},children:x.mode==="move"?"이동":"기간 조정"}),t.jsxs("span",{children:[C[x.id]?.start||new Date(x.originalStart).toISOString().slice(0,10)," ~ ",C[x.id]?.end||new Date(x.originalEnd).toISOString().slice(0,10)]}),t.jsxs("span",{style:{color:"#cbd5e1",opacity:.8},children:["(",Math.ceil((new Date(C[x.id]?.end||x.originalEnd).getTime()-new Date(C[x.id]?.start||x.originalStart).getTime())/(1e3*60*60*24))+1,"일)"]})]})}),E&&t.jsxs("div",{className:"context-menu",style:{top:E.y,left:E.x},children:[t.jsxs("div",{className:"context-menu-item",onClick:()=>je(E.taskId),children:[t.jsx(We,{size:14})," 하위 타스크 추가"]}),t.jsxs("div",{className:"context-menu-item",onClick:()=>{const e=f.find(s=>s.id===E.taskId);e&&J(e)},children:[t.jsx(Te,{size:14})," 상세보기"]}),t.jsxs("div",{className:"context-menu-item",style:{color:"#ff6f6f"},onClick:()=>ve(E.taskId),children:[t.jsx(Me,{size:14})," 삭제"]})]}),ue&&t.jsx("div",{className:"modal-overlay",children:t.jsxs("div",{className:"modal-content",children:[t.jsx("h3",{children:$==="create-root"?"새 작업 (최상위)":$==="create-sub"?"하위 작업 추가":"작업 상세 정보"}),t.jsxs("form",{onSubmit:we,children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"작업명"}),t.jsx("input",{type:"text",value:a.name,onChange:e=>S({...a,name:e.target.value}),autoFocus:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"기간 (일수)"}),t.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:t.jsxs("span",{className:"badge",style:{background:"#6366f1",color:"white",padding:"4px 8px",borderRadius:4,fontSize:"0.8rem"},children:[a.start&&a.end?Math.ceil((new Date(a.end).getTime()-new Date(a.start).getTime())/(1e3*60*60*24))+1:0,"일간"]})}),t.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsx("label",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:"시작일"}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[t.jsx("input",{type:"date",value:a.start,onChange:e=>S({...a,start:e.target.value})}),t.jsxs("span",{style:{fontSize:"0.8rem",color:"#64748b"},children:["(",a.start?new Date(a.start).toLocaleDateString("ko-KR",{weekday:"short"}):"",")"]})]})]}),t.jsxs("div",{style:{flex:1},children:[t.jsx("label",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:"종료일"}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[t.jsx("input",{type:"date",value:a.end,onChange:e=>S({...a,end:e.target.value})}),t.jsxs("span",{style:{fontSize:"0.8rem",color:"#64748b"},children:["(",a.end?new Date(a.end).toLocaleDateString("ko-KR",{weekday:"short"}):"",")"]})]})]})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{children:["진척률 (",a.progress,"%)"]}),t.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center"},children:[t.jsx("input",{type:"range",min:"0",max:"100",value:a.progress,onChange:e=>S({...a,progress:Number(e.target.value)}),style:{flex:1}}),t.jsx("input",{type:"number",min:"0",max:"100",value:a.progress,onChange:e=>S({...a,progress:Math.max(0,Math.min(100,Number(e.target.value)))}),style:{width:80}})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"선행 작업 (WBS 번호)"}),t.jsx("input",{type:"text",placeholder:"예: 1.1, 1.2 (쉼표로 구분)",value:a.predecessorsWbs,onChange:e=>S({...a,predecessorsWbs:e.target.value})}),a.predecessorsWbs&&t.jsx("div",{className:"predecessor-preview",children:Z(a.predecessorsWbs).map(e=>{const s=f.find(n=>n.id===e);return s?t.jsxs("div",{className:"pred-tag",children:[t.jsx("span",{className:"pred-wbs",children:s.wbsNumber}),t.jsx("span",{className:"pred-name",children:s.name}),t.jsxs("span",{className:"pred-date",children:[g(s.end)?new Date(g(s.end)).toLocaleDateString():""," 종료",t.jsxs("span",{style:{marginLeft:4,color:"#94a3b8"},children:["(",g(s.end)?new Date(g(s.end)).toLocaleDateString("ko-KR",{weekday:"short"}):"",")"]})]})]},e):null})})]}),$!=="create-root"&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"상위 작업 정보"}),t.jsx("div",{style:{padding:"8px 12px",background:"rgba(255,255,255,0.05)",borderRadius:4,fontSize:"0.9rem",color:"#cbd5e1"},children:$==="create-sub"?(()=>{const e=f.find(s=>s.id===a.parentId);return e?`상위 작업: ${e.name} (${e.wbsNumber})`:"선택된 상위 작업 없음"})():(()=>{const e=f.find(s=>s.id===a.parentId);return e?`상위 작업: ${e.name} (${e.wbsNumber})`:"최상위 작업 (Root)"})()})]}),t.jsxs("div",{className:"form-actions",style:{marginTop:"1rem",gap:"0.75rem",borderTop:"1px solid #334155",paddingTop:"1.5rem",justifyContent:"flex-end"},children:[t.jsx("button",{type:"button",className:"pill pill-outline",onClick:()=>z(!1),children:"취소"}),t.jsxs("button",{type:"submit",className:"pill",style:{background:"#6366f1",borderColor:"#6366f1"},children:[t.jsx(Ce,{size:16,style:{marginRight:6}}),$==="edit"?"저장":"작업 추가"]})]})]})]})}),t.jsxs("div",{className:"card",style:{marginTop:"1rem"},children:[t.jsx("p",{className:"card-label",children:"선택작업"}),T.size===0?t.jsx("p",{className:"muted",children:"왼쪽 WBS에서 작업을 선택하면 상세 정보가 나타납니다."}):(()=>{const e=Array.from(T)[0],s=f.find(r=>r.id===e);if(!s)return t.jsx("p",{className:"muted",children:"선택된 작업 정보를 불러올 수 없습니다."});const n=`레벨 ${s.depth+1}`,i=s.predecessors?.length?U(s.predecessors):"-",o=(()=>{const r=g(s.start),c=g(s.end);return!r||!c?"-":`${Math.ceil((c-r)/(1e3*60*60*24))+1}일`})(),l=f.filter(r=>r.id!==s.id&&r.wbsNumber.startsWith(`${s.wbsNumber}.`));return t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 260px 120px 120px 1fr",gap:"0.75rem",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"WBS"}),t.jsx("div",{children:s.wbsNumber})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"작업명"}),t.jsx("div",{children:s.name})]}),t.jsxs("div",{style:{whiteSpace:"nowrap"},children:[t.jsx("strong",{children:o==="-"?"작업기간":`작업기간(${o})`}),t.jsx("div",{children:s.start&&s.end?`${String(s.start).slice(0,10)} ~ ${String(s.end).slice(0,10)}`:"-"})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"진척율"}),t.jsxs("div",{children:[s.progress,"%"]})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"레벨"}),t.jsx("div",{children:n})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"선행작업"}),t.jsx("div",{children:i})]}),l.length>0&&t.jsxs("div",{style:{gridColumn:"1 / -1",marginTop:"0.25rem"},children:[t.jsx("strong",{children:"하위 작업"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 260px 120px 120px 1fr",gap:"0.5rem",marginTop:"0.5rem",alignItems:"center"},children:l.map(r=>{const c=(()=>{const y=g(r.start),m=g(r.end);return!y||!m?"-":`${Math.ceil((m-y)/864e5)+1}일`})(),u=r.predecessors?.length?U(r.predecessors):"-",p=r.start&&r.end;return t.jsxs(Ne.Fragment,{children:[t.jsx("div",{style:{color:"#8bd3ff"},children:r.wbsNumber}),t.jsx("div",{children:r.name}),t.jsx("div",{style:{whiteSpace:"nowrap"},children:t.jsx("div",{children:p?`${String(r.start).slice(0,10)} ~ ${String(r.end).slice(0,10)}${c!=="-"?` (${c})`:""}`:"-"})}),t.jsxs("div",{children:[r.progress??0,"%"]}),t.jsx("div",{children:`레벨 ${r.depth+1}`}),t.jsx("div",{children:u})]},r.id)})})]})]})})()]})]})}export{Ge as default};
