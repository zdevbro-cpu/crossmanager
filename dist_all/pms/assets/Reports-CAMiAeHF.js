import{u as w,a as R,b as D,r as n,j as e}from"./index-DLDgXF6I.js";import{c as b,a as f}from"./mock-8k32bwyI.js";import{a as P}from"./validation-CKRFn1w2.js";import{u as S}from"./useRole-CBvHcifX.js";import{P as E,C as k}from"./pencil-1cMlvm32.js";import{T as z,P as L}from"./trash-2-DXkKrmXK.js";import"./useProjectMembers-zrimmaoa.js";import"./useMutation-CV-TupsB.js";import"./createLucideIcon-BDg0D3mO.js";const B=async()=>Promise.resolve(b),F=()=>w({queryKey:["reports"],queryFn:B});function H(){const{selectedId:r}=R(),{show:d}=D(),{data:o,isLoading:N,isError:v}=F(),[g,p]=n.useState(b),[h,j]=n.useState(null),[l,x]=n.useState(null),{role:y}=S(),m=y!=="field";n.useEffect(()=>{o&&p(o)},[o]);const I=g.filter(s=>!r||s.projectId===r),[a,t]=n.useState({projectId:r||"p1",type:"주간",period:"",format:"삼성",createdAt:""});n.useEffect(()=>{r&&t(s=>({...s,projectId:r}))},[r]);const A=async s=>{if(s.preventDefault(),!a.period){j("기간은 필수입니다."),d("기간은 필수입니다.","warning");return}a.createdAt&&P(a.createdAt,a.createdAt);const c={id:l??crypto.randomUUID(),projectId:a.projectId,type:a.type,period:a.period,format:a.format,createdAt:a.createdAt||new Date().toISOString().slice(0,10)};p(i=>l?i.map(u=>u.id===l?c:u):[c,...i]),j(l?"화면에서 수정했습니다. (DB 구현 필요)":"화면에만 추가했습니다. (DB 구현 필요)"),d(l?"화면에서 수정했습니다.":"화면에만 추가했습니다.","info"),t({...a,period:"",createdAt:""}),x(null)},C=async s=>{if(!m){d("현장근무 역할은 보고 삭제 권한이 없습니다.","warning");return}confirm("삭제하시겠습니까?")&&(p(c=>c.filter(i=>i.id!==s)),j("삭제했습니다. (DB 구현 필요)"),d("삭제했습니다.","success"))};return e.jsxs("div",{className:"page",children:[e.jsxs("header",{className:"section-header",children:[e.jsxs("div",{children:[e.jsx("p",{className:"eyebrow",children:"문서/보고 자동화"}),e.jsx("h2",{children:"일일·주간·월간 보고서 자동 생성 + 고객사 양식 변환"}),e.jsx("p",{className:"muted",children:"선택한 프로젝트의 보고서를 관리하고, 고객사별 템플릿을 적용합니다."})]}),e.jsx("div",{className:"pill pill-outline",children:"Cloud Functions · 템플릿 변환"})]}),e.jsxs("section",{className:"card table-card",children:[e.jsxs("div",{className:"table-head",children:[e.jsx("p",{className:"card-label",children:"보고서 (선택한 프로젝트)"}),e.jsx("div",{className:"table-actions",children:e.jsx("button",{className:"pill pill-outline",children:"양식 변환 (준비 중)"})})]}),h&&e.jsx("p",{className:"muted",children:h}),N&&e.jsx("p",{className:"muted",children:"불러오는 중..."}),v&&e.jsx("p",{className:"muted",children:"불러오기 오류, 새로고침 해주세요."}),e.jsxs("div",{className:"table",children:[e.jsxs("div",{className:"table-row table-header",children:[e.jsx("span",{children:"프로젝트"}),e.jsx("span",{children:"유형"}),e.jsx("span",{children:"기간"}),e.jsx("span",{children:"양식"}),e.jsx("span",{children:"작성일"}),e.jsx("span",{children:"관리"})]}),I.map(s=>{const c=f.find(i=>i.id===s.projectId);return e.jsxs("div",{className:"table-row",children:[e.jsx("span",{children:c?.name??s.projectId}),e.jsx("span",{children:s.type}),e.jsx("span",{children:s.period}),e.jsx("span",{children:s.format}),e.jsx("span",{children:s.createdAt}),e.jsxs("span",{className:"row-actions",children:[e.jsx("button",{className:"icon-button",onClick:()=>{x(s.id),t({projectId:s.projectId,type:s.type,period:s.period,format:s.format,createdAt:s.createdAt})},"aria-label":"편집",title:"편집",children:e.jsx(E,{size:18})}),e.jsx("button",{className:"icon-button",onClick:()=>C(s.id),"aria-label":"삭제",title:"삭제",disabled:!m,children:e.jsx(z,{size:18})})]})]},s.id)})]})]}),e.jsxs("section",{className:"card",children:[e.jsx("p",{className:"card-label",children:l?"보고서 수정":"보고서 추가"}),e.jsxs("form",{className:"form-grid",onSubmit:A,children:[e.jsxs("label",{children:[e.jsx("span",{children:"프로젝트"}),e.jsx("select",{value:a.projectId,onChange:s=>t({...a,projectId:s.target.value}),children:f.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}),e.jsxs("label",{children:[e.jsx("span",{children:"유형"}),e.jsxs("select",{value:a.type,onChange:s=>t({...a,type:s.target.value}),children:[e.jsx("option",{value:"일일",children:"일일"}),e.jsx("option",{value:"주간",children:"주간"}),e.jsx("option",{value:"월간",children:"월간"})]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"기간"}),e.jsx("input",{value:a.period,onChange:s=>t({...a,period:s.target.value}),placeholder:"2025-W49"})]}),e.jsxs("label",{children:[e.jsx("span",{children:"양식"}),e.jsxs("select",{value:a.format,onChange:s=>t({...a,format:s.target.value}),children:[e.jsx("option",{value:"삼성",children:"삼성"}),e.jsx("option",{value:"LG",children:"LG"}),e.jsx("option",{value:"기타",children:"기타"})]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"작성일"}),e.jsx("input",{type:"date",value:a.createdAt,onChange:s=>t({...a,createdAt:s.target.value})})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"submit",className:"icon-button","aria-label":"추가",children:l?e.jsx(k,{size:18}):e.jsx(L,{size:18})})})]})]}),e.jsxs("section",{className:"grid two",children:[e.jsxs("article",{className:"card",children:[e.jsx("p",{className:"card-label",children:"핵심 기능"}),e.jsxs("ul",{className:"list",children:[e.jsx("li",{children:"일일/주간/월간 보고서 자동 생성, 사진·이슈 삽입 준비"}),e.jsx("li",{children:"고객사 템플릿(삼성/LG) 선택 적용"}),e.jsx("li",{children:"보고서 생성 이력과 작성자 기록"})]})]}),e.jsxs("article",{className:"card",children:[e.jsx("p",{className:"card-label",children:"데이터 키"}),e.jsxs("ul",{className:"list",children:[e.jsxs("li",{children:["`reports`: ","{projectId, type, period, format, createdAt}"]}),e.jsx("li",{children:"보고서 파일 링크/이미지 첨부 필드 확장 예정"})]})]})]})]})}export{H as default};
