# Contract File Storage Migration - Task Checklist

## Phase 1: DB Schema (✅ 완료 - 2025-12-13)
- [x] 분석 및 계획 수립
- [x] Migration 스크립트 작성 (SQL + Node.js)
- [x] DB 컬럼 추가 실행
  - [x] `attachment_path` TEXT
  - [x] `attachment_size` BIGINT  
  - [x] `attachment_name` VARCHAR(255)
- [x] 컬럼 추가 검증 완료
- [x] Git 커밋 및 푸시

## Phase 2: Backend API (⏳ 대기 중)
- [ ] `server/routes/contracts.js`에 Firebase Storage 통합
  - [ ] Firebase Admin SDK 초기화
  - [ ] Multer/Busboy 파일 업로드 처리
  - [ ] Storage 업로드 로직 추가
  - [ ] Signed URL 생성 API
- [ ] POST `/api/contracts` 수정 (파일 업로드 지원)
- [ ] PUT `/api/contracts/:id` 수정 (파일 업데이트 지원)
- [ ] GET `/api/contracts/:id` 수정 (Signed URL 반환)
- [ ] 로컬 테스트

## Phase 3: Frontend (⏳ 대기 중)
- [ ] `pms/src/pages/Contracts.tsx` 수정
  - [ ] 파일 업로드 UI 추가
  - [ ] `multipart/form-data` 전송 로직
  - [ ] 파일 다운로드 버튼 추가
- [ ] 테스트: 신규 계약서 등록 및 다운로드

## Phase 4: 배포 (⏳ 대기 중)
- [ ] Firebase Functions 배포
- [ ] Firebase Hosting 배포
- [ ] 프로덕션 테스트
- [ ] 문서 업데이트

## 다음 세션 시작 가이드
새로운 채팅 창에서:
> "파일 `docs/pms/PMS_계약견적_개발현황.md` 섹션 8을 읽고, Contract 파일 저장 방식 개선 작업을 Phase 2 (Backend API)부터 이어서 진행해줘."
